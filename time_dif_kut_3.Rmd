---
title: "time_dif_kut_3"
author: "Stróbl Anita"
date: "2025-12-20"
output: html_document
---

```{r setup, include=FALSE}
install.packages(c("rmarkdown", "knitr"))
knitr::opts_chunk$set(echo = TRUE)
```

```{r adat_beolvasas_es_elokeszites}

# Csomagok betöltése
if (!require("tidyverse")) install.packages("tidyverse")
if (!require("readxl")) install.packages("readxl")

library(tidyverse)
library(readxl)

# --- ADATBEOLVASÁS ---
raw_data <- read_excel("RE_E_merge_1_87.xlsx")

# Ellenőrzés: az első pár sor kiírása
head(raw_data)
```

```{r demografiai_elemzes}

# --- ADATSZŰRÉS (DISTINCT) ---

# Adattábla, ahol minden ID csak egyszer szerepel.
demografia_data <- raw_data %>%
  distinct(ID, .keep_all = TRUE) %>% 
  select(ID, sex, group) # Csak a szükséges oszlopokat tartjuk meg

# 1) Összesen hány főből áll a minta
total_N <- nrow(demografia_data)
cat("1. A minta teljes elemszáma:", total_N, "fő\n\n")

# 2) Összesen hány százalék nő
nemek_oszlasa <- demografia_data %>%
  count(sex) %>%
  mutate(szazalek = n / sum(n) * 100)

cat("2. Nemek megoszlása a teljes mintában:\n")
print(nemek_oszlasa)
cat("\n")

# 3) A különböző csoportokban (normal, bp_hr, sz_hr) összesen hány fő van
csoport_letszam <- demografia_data %>%
  count(group)

cat("3. Vizsgálati személyek száma csoportonként:\n")
print(csoport_letszam)
cat("\n")

# 4) A különböző csoportok hány százaléka nő
csoport_nem_szazalek <- demografia_data %>%
  group_by(group, sex) %>%
  count() %>%
  group_by(group) %>% 
  mutate(szazalek = round(n / sum(n) * 100, 2)) 

cat("4. Nemek százalékos megoszlása csoportonként:\n")
print(csoport_nem_szazalek)
```

```{r leiro_statisztika_csoportositva}

# --- ADATOK CSOPORTOSÍTÁSA (BINNING) ---
processed_data <- raw_data %>%
  mutate(prod_int = as.numeric(prod_int)) %>% 
  mutate(
    ref_category = case_when(
      ref_frame %in% c(38, 39) ~ "39 frame (rövid)",
      ref_frame %in% c(80, 81, 82) ~ "81 frame (közepes)",
      ref_frame %in% c(109, 110, 111, 112) ~ "111 frame (hosszú)",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(!is.na(ref_category)) %>% 
 
   # Beállítjuk a sorrendet, hogy az ábrán növekvőben legyen, ne ABC sorrendben
  mutate(ref_category = factor(ref_category, levels = c("39 frame (rövid)", "81 frame (közepes)", "111 frame (hosszú)")))

# --- LEÍRÓ STATISZTIKA ---

descriptive_stats <- processed_data %>%
  group_by(group, ref_category) %>%
  summarise(
    N_obs = n(),                                     
    Mean_Prod = mean(prod_int, na.rm = TRUE),        
    SD_Prod = sd(prod_int, na.rm = TRUE),            
    SE_Prod = sd(prod_int, na.rm = TRUE) / sqrt(n()) 
  ) %>%
  ungroup()

print("Leíró statisztikák (Összevont ingerhosszok alapján):")
print(descriptive_stats)
```

```{r vizualizacio_modositott}

# --- ADATOK ELŐKÉSZÍTÉSE A VIZUALIZÁCIÓHOZ ---
plot_data <- processed_data %>%
  filter(group %in% c("normal", "sz_hr")) %>%
  mutate(group = factor(group, 
                        levels = c("sz_hr", "normal"), 
                        labels = c("Skizotíp", "Kontrollcsoport")))

# --- ÁBRÁZOLÁS ---
plot_boxplot_filtered <- ggplot(plot_data, aes(x = ref_category, y = prod_int, fill = group)) +
  geom_boxplot(outlier.alpha = 0.5, outlier.shape = 16) +
  scale_fill_brewer(palette = "Set2") + 
  labs(
    title = "Reprodukált időtartamok: skizotíp vs. kontrollcsoport",
    x = "Referencia Inger",
    y = "Reprodukált Idő",
    fill = "Vizsgálati Csoport"
  ) +
  theme_minimal() +
  theme(
    legend.position = "right", 
    text = element_text(size = 10),
    plot.title = element_text(face = "bold")
  )

# Ábra megjelenítése
print(plot_boxplot_filtered)
```

```{r lmm_h1}

# Csomagok betöltése
if (!require("lmerTest")) install.packages("lmerTest")
if (!require("emmeans")) install.packages("emmeans")

library(lmerTest)
library(emmeans)

# --- 1. ADATELŐKÉSZÍTÉS ---
lmm_data <- processed_data %>%
  filter(group %in% c("normal", "sz_hr")) %>%
  mutate(
    prod_int = as.numeric(gsub(",", ".", as.character(prod_int))),
    ref_ms = as.numeric(gsub(",", ".", as.character(ref_ms)))
  ) %>%
  mutate(bias = prod_int - ref_ms) %>%
  mutate(group = factor(group, levels = c("normal", "sz_hr")))

# Ellenőrizzük, hogy sikerült-e a számítás (az első pár sor kiírása)
print("Az adatok előkészítve, az első sorok:")
print(head(lmm_data %>% select(ID, group, ref_ms, prod_int, bias)))

# --- 2. MODELL ÉPÍTÉS ---
# Bias ~ Csoport * Ingerhossz + (Random hatás: Személy)
model_bias <- lmer(bias ~ group * ref_category + (1 | ID), data = lmm_data)

# --- 3. EREDMÉNYEK (ANOVA TÁBLA) ---
cat("\n--- A Modell ANOVA táblázata (Főhatások és Interakció) ---\n")
print(anova(model_bias, type = 3))
```

```{r h1_vizualizacio_posthoc}

# --- 1. POST-HOC ELEMZÉS (Opcionális, de ajánlott) ---
# Kiszámoljuk a csoportok átlagos hibáját (Estimated Marginal Means)
# Ez korrigált átlag, ami pontosabb, mint a sima mean()
emm_results <- emmeans(model_bias, ~ group | ref_category)

cat("--- Csoportok összehasonlítása ingerhosszonként (Post-hoc) ---\n")
print(pairs(emm_results)) # Páronkénti összehasonlítás p-értékekkel

# --- 2. VIZUALIZÁCIÓ: SZISZTEMATIKUS HIBA (BIAS) ---
plot_data_bias <- lmm_data %>%
  mutate(group_label = factor(group, 
                              levels = c("sz_hr", "normal"), 
                              labels = c("Skizotíp", "Kontrollcsoport")))
ggplot(plot_data_bias, aes(x = ref_category, y = bias, fill = group_label)) +
  geom_boxplot(outlier.alpha = 0.3, outlier.size = 1) +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Szisztematikus Pontosság vizsgálata",
    x = "Referencia Inger (Kategória)",
    y = "Időészlelési Hiba (mp) [Válasz - Inger]",
    fill = "Csoport"
  ) +
  theme_minimal() +
  theme(
    legend.position = "right",
    text = element_text(size = 10),
    plot.title = element_text(face = "bold")
  )
```

```{r lmm_h2_accuracy}
# Csomag a modell magyarázóerejének (R2) számításához
if (!require("MuMIn")) install.packages("MuMIn")
library(MuMIn)

# --- 1. Regressziós Együtthatók (A predikció iránya és mértéke) ---
# A summary() adja meg a részletes "Estimate" értékeket
model_summary <- summary(model_bias)

cat("--- A Skizotípia mint prediktor (Regressziós Együtthatók) ---\n")
# Csak a fix hatásokat (Fixed effects) íratjuk ki, ezek a lényegesek most
print(model_summary$coefficients)

# --- 2. Értelmezési Segédlet (Konzolba kiírva) ---
sz_hr_beta <- model_summary$coefficients["groupsz_hr", "Estimate"]
sz_hr_p <- model_summary$coefficients["groupsz_hr", "Pr(>|t|)"]

cat("\n--- ÉRTELMEZÉS ---\n")
cat(paste0("A 'groupsz_hr' sor Estimate értéke (", round(sz_hr_beta, 4), ") mutatja a különbséget.\n"))
if(sz_hr_p < 0.05) {
  cat("Mivel p < 0.05, a hipotézis IGAZOLT: A skizotíp csoporttagság szignifikánsan előrejelzi a torzítást.\n")
  if(sz_hr_beta > 0) {
    cat("Az irány POZITÍV: A skizotíp csoport hajlamosabb a TÚLBECSLÉSRE a kontrollhoz képest.\n")
  } else {
    cat("Az irány NEGATÍV: A skizotíp csoport hajlamosabb az ALULBECSLÉSRE a kontrollhoz képest.\n")
  }
} else {
  cat("A hipotézis NEM igazolt: Nincs szignifikáns prediktív kapcsolat.\n")
}

# --- 3. Modell Erejének Vizsgálata (R-négyzet) ---
# A marginal R2 (R2m) mutatja a fix faktorok (Csoport, Ingerhossz) erejét
# A conditional R2 (R2c) mutatja a teljes modell erejét (az egyéni különbségekkel együtt)
r2_values <- r.squaredGLMM(model_bias)

cat("\n--- Mennyire erős a modell? (R-négyzet) ---\n")
print(r2_values)
cat("R2m (Marginal): Ennyit magyaráz önmagában a csoport és az ingerhossz.\n")
cat("R2c (Conditional): Ennyit magyaráz a modell, ha figyelembe vesszük az egyéni ingadozást is.\n")
```

```{r h3_intra_individual_variability_cv}
# --- 1. ADATOK AGGREGÁLÁSA (CV számítása) ---
# Most nem 'trial-level' (soronkénti), hanem 'subject-level' (személy szintű) adatbázist készítünk.

iiv_data <- processed_data %>%
  filter(group %in% c("normal", "sz_hr")) %>%
  mutate(prod_int = as.numeric(gsub(",", ".", as.character(prod_int)))) %>%
  group_by(ID, group, ref_category) %>%
  
  # Kiszámoljuk a mutatókat:
  summarise(
    sd_prod = sd(prod_int, na.rm = TRUE),
    mean_prod = mean(prod_int, na.rm = TRUE),
    cv_prod = sd_prod / mean_prod, 
    .groups = "drop" 
  ) %>%
  mutate(group = factor(group, levels = c("normal", "sz_hr")))

# --- 2. MODELL ÉPÍTÉS (LMM az aggregált adatokon) ---
# Itt már kevesebb sorunk van (személyenként 3 db), de mivel
# egy személytől több adat van (3 különböző időtartam), kell a random hatás (1|ID).

# Hipotézis: A skizotíp csoport CV-je magasabb (nagyobb az ingadozás).
model_cv <- lmer(cv_prod ~ group * ref_category + (1 | ID), data = iiv_data)

# --- 3. EREDMÉNYEK ---
cat("--- Egyéni Ingadozás (CV) ANOVA Táblázata ---\n")
print(anova(model_cv, type = 3))

# --- 4. POST-HOC és REGRESSZIÓS BECSLÉS ---
# Mennyivel nagyobb az ingadozás a skizotíp csoportnál?
cat("\n--- Mennyivel 'zajosabb' a skizotíp csoport? (Becslés) ---\n")
print(summary(model_cv)$coefficients["groupsz_hr", ])

# --- 5. VIZUALIZÁCIÓ ---
plot_data_iiv <- iiv_data %>%
  mutate(group_label_iiv = factor(group, 
                              levels = c("sz_hr", "normal"), 
                              labels = c("Skizotíp", "Kontrollcsoport")))
ggplot(plot_data_iiv, aes(x = ref_category, y = cv_prod, fill = group_label_iiv)) +
  geom_boxplot(outlier.alpha = 0.5) +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Belső Ingadozás (Variációs Együttható - CV)",
    subtitle = "Magasabb érték = Nagyobb bizonytalanság/zaj az észlelésben",
    x = "Referencia Inger",
    y = "Variációs Együttható [SD / Mean]",
    fill = "Csoport"
  ) +
  theme_minimal() +
  theme(
    legend.position = "right",
    text = element_text(size = 10),
    plot.title = element_text(face = "bold")
  )
```

```{r cv_t_teszt_38_frame}
# Csomag betöltése
if (!require("rstatix")) install.packages("rstatix")
library(rstatix)

# --- 1. ADATELŐKÉSZÍTÉS ---
cv_stats_38 <- processed_data %>%
  filter(ref_frame %in% c(38, 39)) %>%
  filter(group %in% c("normal", "sz_hr")) %>%
  mutate(group = as.character(group)) %>%
  mutate(group = factor(group, levels = c("normal", "sz_hr"))) %>%
  mutate(prod_int = as.numeric(gsub(",", ".", as.character(prod_int)))) %>%
  # CV számítása
  group_by(ID, group) %>%
  summarise(
    person_cv = sd(prod_int, na.rm = TRUE) / mean(prod_int, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  filter(!is.na(person_cv)) %>%
  filter(is.finite(person_cv))

# --- 2. DIAGNOSZTIKA (Hibaellenőrzés) ---
cat("--- ELLENŐRZÉS: Csoportlétszámok a tisztítás után ---\n")
letszam <- table(cv_stats_38$group)
print(letszam)

# --- 3. STATISZTIKAI TESZT ---
if(length(letszam) == 2 && all(letszam > 1)) {
  # Welch t-próba (irányított: normal < sz_hr)
  t_test_cv <- t.test(person_cv ~ group, data = cv_stats_38, alternative = "less")
  cat("\n--- Welch-féle t-próba eredménye (CV különbség) ---\n")
  print(t_test_cv)
  # Hatásnagyság (Cohen's d)
  cat("\n--- Hatásnagyság (Cohen's d) ---\n")
  tryCatch({
    eff <- cv_stats_38 %>% cohens_d(person_cv ~ group)
    print(eff)
  }, error = function(e) { cat("A hatásnagyság számítása közben hiba lépett fel, de a t-próba érvényes.\n")})

  # Átlagok
  cat("\n--- Csoportátlagok (CV) ---\n")
  print(cv_stats_38 %>% group_by(group) %>% summarise(Atlag_CV = mean(person_cv), N = n()))
} else {
  cat("\n!!! HIBA !!!\n")
  cat("Az egyik csoport üres maradt a szűrés után.\n")
  cat("Kérlek ellenőrizd, hogy a 'ref_frame' oszlopban tényleg szerepelnek-e a 38-as vagy 39-es értékek,\n")
  cat("és hogy a 'group' oszlopban helyesek-e a nevek (normal, sz_hr).")
}
```

```{r lmm_h4_cv_predikcio}
# Csomagok betöltése
library(lmerTest)
library(MuMIn)
library(tidyverse)

# --- 1. ADATELŐKÉSZÍTÉS (CV számítása) ---
cv_pred_data <- processed_data %>%
  filter(group %in% c("normal", "sz_hr")) %>%
  mutate(
    prod_int = as.numeric(gsub(",", ".", as.character(prod_int)))
  ) %>%
  group_by(ID, group, ref_category) %>%
  summarise(
    sd_val = sd(prod_int, na.rm = TRUE),
    mean_val = mean(prod_int, na.rm = TRUE),
    cv_value = sd_val / mean_val, # Ez a Variációs Együttható
    .groups = "drop"
  ) %>%
  # Referencia beállítása (Normal csoport legyen a bázis)
  mutate(group = factor(group, levels = c("normal", "sz_hr"))) %>%
  # Hibás adatok (pl. 0 szórás) szűrése
  filter(is.finite(cv_value))

# --- 2. MODELL ÉPÍTÉS (Predikció) ---
# Kérdés: A csoporttagság előrejelzi-e a CV növekedését?
# Formula: CV ~ Csoport * Ingerhossz + (1 | ID)
model_cv_pred <- lmer(cv_value ~ group * ref_category + (1 | ID), data = cv_pred_data)

# --- 3. EREDMÉNYEK: REGRESSZIÓS EGYÜTTHATÓK ---
summary_cv <- summary(model_cv_pred)

cat("--- Regressziós Együtthatók (CV Predikció) ---\n")
# A táblázatban a 'Estimate' oszlop mutatja az előrejelzés erejét
print(summary_cv$coefficients)

# --- 4. ÉRTELMEZÉS (Automata) ---
beta_cv <- summary_cv$coefficients["groupsz_hr", "Estimate"]
p_val_cv <- summary_cv$coefficients["groupsz_hr", "Pr(>|t|)"]

cat("\n--- A HIPOTÉZIS ÉRTÉKELÉSE (CV) ---\n")
cat(paste0("A 'groupsz_hr' becsült hatása (Estimate): ", round(beta_cv, 4), "\n"))

if (p_val_cv < 0.05) {
  cat("EREDMÉNY: Szignifikáns predikció (p < 0.05).\n")
  if (beta_cv > 0) {
    cat("IRÁNY: A skizotíp csoporttagság NÖVELI a variációs együtthatót (zajosabb belső óra).\n")
    cat("A hipotézis IGAZOLT: A skizotípia előrejelzi az ingadozás zavarát.\n")
  } else {
    cat("IRÁNY: A skizotíp csoporttagság CSÖKKENTI a variációs együtthatót (stabilabb működés).\n")
  }
} else if (p_val_cv < 0.1) {
    cat("EREDMÉNY: Trendszintű (marginális) hatás (0.05 < p < 0.1).\n")
    cat("A csoporttagság tendenciájában jelzi előre a zavart, de nem éri el a szignifikancia küszöbét.\n")
} else {
  cat("EREDMÉNY: Nem szignifikáns (p > 0.05).\n")
  cat("A csoporttagság nem jelzi előre megbízhatóan a CV értékét a teljes modellen nézve.\n")
}

# --- 5. MODELL MAGYARÁZÓEREJE ---
cat("\n--- Modell Magyarázóereje (R-négyzet) ---\n")
print(r.squaredGLMM(model_cv_pred))
```

```{r pontabra_38_frame}
# --- 1. ADATELŐKÉSZÍTÉS ---
dotplot_data <- processed_data %>%
  # Szűrés: Csak a 38-as frame (rövid) és a két csoport
  filter(ref_frame <= 39) %>%
  filter(group %in% c("normal", "sz_hr")) %>%
  
  # --- SORRENDEZÉS (A kulcslépés) ---
  # 1. Először rendezzük az adatokat Csoport, majd ID szerint
  arrange(group, ID) %>%
  # 2. Rögzítjük az ID-k sorrendjét faktorként
  # Így a ploton először a 'normal' ID-k jönnek, utána a 'sz_hr' ID-k
  mutate(ID = factor(ID, levels = unique(ID))) %>%
  
  # Számok biztosítása
  mutate(prod_int = as.numeric(gsub(",", ".", as.character(prod_int)))) %>%
  
  # Csoport nevek szépítése
  mutate(group_label = factor(group, 
                              levels = c("normal", "sz_hr"), 
                              labels = c("Kontrollcsoport", "Skizotíp")))

# --- 2. ÁBRÁZOLÁS ---
ggplot(dotplot_data, aes(x = ID, y = prod_int, color = group_label)) +
  # A pontok kirajzolása (kicsit áttetsző, hogy lássuk a sűrűsödést)
  geom_point(alpha = 0.6, size = 2) +
  
  # Egy elválasztó vonal a két csoport közé
  # (Megkeressük, hol vált a csoport, oda húzunk egy vonalat - ez manuálisabb, 
  #  ezért egyszerűbb, ha a színek különítik el, de itt egy vizuális trükk:)
  facet_grid(~group_label, scales = "free_x", space = "free") +
  
  scale_color_brewer(palette = "Set2") +
  labs(
    title = "Egyéni válaszok eloszlása (38 frame / Rövid inger)",
    subtitle = "Minden pont egy konkrét választ jelöl",
    x = "Vizsgálati Személyek (ID)",
    y = "Reprodukált időtartam (mp)",
    color = "Csoport"
  ) +
  theme_minimal() +
  theme(
    # Az X tengely feliratait elforgatjuk 90 fokkal, hogy olvashatóak legyenek
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1, size = 8),
    legend.position = "top"
  )
```

```{r lmm_h3_precizitas}

# --- 1. ADATELŐKÉSZÍTÉS ---
lmm_precision_data <- processed_data %>%
  filter(group %in% c("normal", "sz_hr")) %>%
  mutate(
    prod_int = as.numeric(gsub(",", ".", as.character(prod_int))),
    ref_ms = as.numeric(gsub(",", ".", as.character(ref_ms)))
  ) %>%
  # --- A LÉNYEG: Abszolút Hiba számítása ---
  # Az abs() függvény leveszi a negatív előjelet.
  mutate(abs_error = abs(prod_int - ref_ms)) %>%
  mutate(group = factor(group, levels = c("normal", "sz_hr")))

# --- 2. MODELL ÉPÍTÉS (LMM) ---
model_precision <- lmer(abs_error ~ group * ref_category + (1 | ID), data = lmm_precision_data)

# --- 3. EREDMÉNYEK (ANOVA) ---
cat("--- Precizitás (Abszolút Hiba) ANOVA Táblázata ---\n")
print(anova(model_precision, type = 3))

# --- 4. POST-HOC Elemzés (Számszerűsítés) ---
emm_precision_interaction <- emmeans(model_precision, ~ group | ref_category)
cat("\n--- Átlagos Abszolút Hiba (becsült) Csoportonként ---\n")
# Azt várjuk, hogy a sz_hr értéke magasabb lesz (nagyobb hiba = rosszabb precizitás)
print(emm_precision)

# --- 5. VIZUALIZÁCIÓ ---
ggplot(lmm_precision_data, aes(x = ref_category, y = abs_error, fill = group)) +
  geom_boxplot(outlier.alpha = 0.3) +
  scale_fill_brewer(palette = "Set2") + 
  labs(
    title = "Precizitás vizsgálata",
    x = "Referencia Inger",
    y = "Abszolút Hiba (mp) |Válasz - Inger|",
    fill = "Csoport"
  ) +
  theme_minimal() +
  theme(
    legend.position = "right",
    text = element_text(size = 10),
    plot.title = element_text(face = "bold")
  )
```

```{r lmm_h4_precizitas_predikcio}
# Csomagok
if (!require("lmerTest")) install.packages("lmerTest")
if (!require("MuMIn")) install.packages("MuMIn")
library(lmerTest)
library(MuMIn)

# --- 1. ADATELŐKÉSZÍTÉS ---
# Biztosítjuk, hogy az abszolút hiba (precizitás hiánya) helyesen legyen kiszámolva
pred_precision_data <- processed_data %>%
  filter(group %in% c("normal", "sz_hr")) %>%
  mutate(
    prod_int = as.numeric(gsub(",", ".", as.character(prod_int))),
    ref_ms = as.numeric(gsub(",", ".", as.character(ref_ms)))
  ) %>%
  # Abszolút hiba = Mennyire tér el a válasz az ingertől (iránytól függetlenül)
  mutate(abs_error = abs(prod_int - ref_ms)) %>%
  # Referencia beállítása: A bázis a 'normal' csoport és a 'Rövid' inger
  mutate(group = factor(group, levels = c("normal", "sz_hr")))

# --- 2. MODELL ÉPÍTÉS (Predikció) ---
# Kérdés: A csoporttagság előrejelzi-e a hiba növekedését?
# Formula: Abszolút Hiba ~ Csoport * Ingerhossz + (1 | ID)
model_prec_pred <- lmer(abs_error ~ group * ref_category + (1 | ID), data = pred_precision_data)

# --- 3. EREDMÉNYEK: REGRESSZIÓS EGYÜTTHATÓK ---
# Ez a tábla mutatja meg az előrejelzés irányát és erejét
model_summary_prec <- summary(model_prec_pred)

cat("--- Regressziós Együtthatók (Prediction Coefficients) ---\n")
# Csak a fix hatásokat kérjük le (az Intercept, a Csoport és az Ingerhossz hatását)
print(model_summary_prec$coefficients)

# --- 4. RÉSZLETES ÉRTELMEZÉS (Automata kiíratás) ---
beta_sz <- model_summary_prec$coefficients["groupsz_hr", "Estimate"]
p_val_sz <- model_summary_prec$coefficients["groupsz_hr", "Pr(>|t|)"]

cat("\n--- A HIPOTÉZIS ÉRTÉKELÉSE ---\n")
cat(paste0("A 'groupsz_hr' becsült hatása (Estimate): ", round(beta_sz, 4), "\n"))

if (p_val_sz < 0.05) {
  cat("A csoporttagság SZIGNIFIKÁNSAN előrejelzi a precizitást (p < 0.05).\n")
  if (beta_sz > 0) {
    cat("IRÁNY: POZITÍV -> A skizotíp csoporttagság NÖVELI az abszolút hibát (rontja a precizitást).\n")
    cat("Konklúzió: A hipotézis IGAZOLT.\n")
  } else {
    cat("IRÁNY: NEGATÍV -> A skizotíp csoporttagság CSÖKKENTI a hibát (javítja a precizitást).\n")
  }
} else {
  cat("Nem találtunk szignifikáns főhatást (p > 0.05), a csoporttagság önmagában nem jelzi előre a precizitást.\n")
  cat("(Érdemes megnézni az interakciókat is a fenti táblázatban!)\n")
}

# --- 5. MODELL MAGYARÁZÓEREJE ---
cat("\n--- Mennyire erős a modell? (R-squared) ---\n")
print(r.squaredGLMM(model_prec_pred))
```